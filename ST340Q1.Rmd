---
title: "ST340CW1Mihir"
author: "u1729346"
date: "22/10/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Question 1

```{r merge}
mergeLR <- function(a, b){
  ret <- numeric(length(a) + length(b))
  i <- 1
  j <- 1
  k <- 1
  while(i <= length(a) || j <= length((b))) {
    if(i <= length(a) && j <= length((b))){
      if(a[i] < b[j]){
        ret[k] <- a[i]
        i <- i + 1
        k <- k + 1
      }
      else{
        ret[k] <- b[j]
        j <- j + 1
        k <- k + 1
      }
    }
    else if(i <= length(a)){
      ret[k] <- a[i]
      k <- k + 1
      i <- i + 1 
    }
    else if(j <= length(b)){
      ret[k] <- b[j]
      k <- k + 1
      j <- j + 1     
    }
  }
  return(ret)
}
```

```{r mergesort}
mergesort <- function(a){
  if(length(a) == 1){
    return(a)
  }
  else{
    mid <- floor(length(a)/2)
    left <- numeric(mid)
    right <- numeric(length(a) - mid)
    for(i in 1:length(left)){
      left[i] <- a[i]
      }
    for(j in 1:length(right)){
      right[j] <- a[j + mid]
    }
    return(mergeLR(mergesort(left), mergesort(right)))
  }
}
```

```{r test}
input <- c(1,2,2.34,2000,-12,-5,9)
print(mergesort(input))
```

#### Mergesort Correctness

Proposition: Mergesort correctly sorts an array ($a[1],...,a[n]$) of size n.

Base Case: When $n=1$, $a[1]$ is sorted by default since it contains only one element. 

Inductive Hypothesis: When $n=k$, the array is correctly sorted by mergesort. i.e. $a[1]\leq ... \leq a[k]$.

Inductive Step: When $n=k+1$,
$$mid=\lfloor{\frac{k+1}{2}}\rfloor$$
$$left = a[1],...,a[mid]$$
$$right = a[mid+1],...,a[k+1]$$

Since $\lfloor{\frac{k+1}{2}}\rfloor \leq k$ and $k+1-(\lfloor{\frac{k+1}{2}}\rfloor + 1) = k - \lfloor{\frac{k+1}{2}}\rfloor<k$, left and right will be correctly sorted by mergesort as assumed in our inductive hypothesis. We must show that mergeLR correctly outputs a sorted array when called upon left and right.

Proposition: mergeLR correctly returns a single array with the elements of the two input arrays in sorted order. Suppose left and right are two arrays with lengths p and q respectively and the algorithm is on its $k^{th}$ 

Base Case: When $k =1$, 
$$ret = concat(min\{left[1],right[1]\}, max\{left[1],right[1]\})$$
Hence, the returned array is in correct sorted order.

Inductive Hypothesis: For arbitrary $k$, the returned merged array is correctly sorted. i.e. $ret[1] \leq ...\leq ret[k]$. 

Inductive Step: 